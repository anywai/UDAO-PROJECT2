<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/treasury/PlatformTreasury.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">contracts/treasury/</a> PlatformTreasury.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">65.91% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>29/44</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">43.75% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>7/16</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">66.67% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>4/6</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">61.82% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>34/55</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
/// @title Platform Treasury contract for the UDAO Platform's primary financial operations.
/// @author anywaiTR: Bugrahan Duran, Batuhan Darcin
/// @notice This contract manages revenue distribution and withdrawals for the UDAO Platform, inheriting critical functionalities from the ContentManager and BasePlatform contracts.
/// @dev The contract facilitates platform revenue distribution, role dependent revenue share management, and instructor withdrawals based on a refund window mechanism.
&nbsp;
pragma solidity ^0.8.4;
import "./ContentManager.sol";
&nbsp;
contract PlatformTreasury is ContentManager {
    ///@notice this event gets triggered when founcation withdraw tokens
    /// @param amount The amount of tokens withdrawn
    event FoundationWithdrawn(uint amount);
    ///@notice this event gets triggered when a instructor withdraw tokens
    /// @param instructor The address of the instructor
    /// @param amount The amount of tokens withdrawn
    /// @param debt The amount of tokens that are not withdrawn due to the debt
    event InstructorWithdrawn(
        address indexed instructor,
        uint amount,
        uint debt
    );
    /// @notice this event gets triggered when the refund window is updated
    /// @param newWindow The new refund window period
    event RefundWindowUpdated(uint newWindow);
&nbsp;
    /// @notice constructor of the PlatformTreasury contract
    /// @param _rmAddress The address of the deployed role manager
    /// @param _udaoAddress The address of the deployed UDAO token
    /// @param _udaocAddress The address of the deployed UDAOC token
    /// @param _governanceTreasuryAddress The address of the deployed governance treasury
    /// @param _voucherVerifierAddress The address of the deployed voucher verifier
    constructor(
        address _rmAddress,
        address _udaoAddress,
        address _udaocAddress,
        address _governanceTreasuryAddress,
        address _voucherVerifierAddress
    )
        BasePlatform(
            _rmAddress,
            _udaoAddress,
            _udaocAddress,
            _governanceTreasuryAddress,
            _voucherVerifierAddress
        )
    {}
&nbsp;
    /// @notice Allows anyone to update the platform cut balances and transfer the platform cut to governance
<span class="fstat-no" title="function not covered" >    function updateAndTransferPlatformBalances() external {</span>
        /// @dev this is the timestamp of the transaction in days
<span class="cstat-no" title="statement not covered" >        uint256 transactionTime = (block.timestamp / 86400);</span>
        /// @dev transactionLBIndex determines a "transaction time dependent position" in the Locked balanaces array.
<span class="cstat-no" title="statement not covered" >        uint256 transactionLBIndex = transactionTime % refundWindow;</span>
        /// @dev update platform cut (coaching&amp;content) pools and platform locked pools
<span class="cstat-no" title="statement not covered" >        _updatePlatformCutBalances(</span>
            0, //contentCut=0 due to there is no content revenue on this transaction
            0, //coachingCut=0 due to there is no coaching revenue on this transaction
            transactionTime,
            transactionLBIndex
        );
        /// @dev if there is any revenue in platform cut pools, distribute role shares to roles and transfer governance role shares to governance treasury
<span class="cstat-no" title="statement not covered" >        _transferPlatformCutstoGovernance()</span>;
    }
&nbsp;
    /// @notice withdraws foundation balance to foundation wallet
    function withdrawFoundation() external <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            hasRole(FOUNDATION_ROLE, msg.sender),
            "Only foundation can withdraw"
        );
        /// @dev this is the timestamp of the transaction in days
        uint256 transactionTime = (block.timestamp / 86400);
        /// @dev transactionLBIndex determines a "transaction time dependent position" in the Locked balanaces array.
        uint256 transactionLBIndex = transactionTime % refundWindow;
        /// @dev update platform cut (coaching&amp;content) pools and platform locked pools
        _updatePlatformCutBalances(
            0, //contentCut=0 due to there is no content revenue on this transaction
            0, //coachingCut=0 due to there is no coaching revenue on this transaction
            transactionTime,
            transactionLBIndex
        );
        /// @dev if there is any revenue in platform cut pools, distribute role shares to roles and transfer governance role shares to governance treasury
        _transferPlatformCutstoGovernance();
        /// @dev calculate the withdrawable balance of foundation
        uint withdrawableBalance = foundationBalance;
        /// @dev zeroing before the actual withdraw
        foundationBalance = 0; /// @dev zeroing before the actual withdraw
        /// @dev transfer the withdrawable balance to the foundation wallet
        udao.transfer(foundationWallet, withdrawableBalance);
&nbsp;
        emit FoundationWithdrawn(withdrawableBalance);
    }
&nbsp;
    /// @notice Allows instructers to withdraw individually.
    function withdrawInstructor() external <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            getWithdrawableBalanceInstructor(msg.sender) &gt; 0,
            "No balance to withdraw"
        );
        /// @dev this is the timestamp of the transaction in days
        uint256 transactionTime = (block.timestamp / 86400);
        /// @dev transactionLBIndex determines a "transaction time dependent position" in the Locked balanaces array.
        uint256 transactionLBIndex = transactionTime % refundWindow;
        /// @dev update platform cut (coaching&amp;content) pools and platform locked pools
        _updatePlatformCutBalances(
            0, //contentCut=0 due to there is no content revenue on this transaction
            0, //coachingCut=0 due to there is no coaching revenue on this transaction
            transactionTime,
            transactionLBIndex
        );
        /// @dev if there is any revenue in platform cut pools, distribute role shares to roles and transfer governance role shares to governance treasury
        _transferPlatformCutstoGovernance();
        /// @dev update instructor balance and instructor locked balances,
        _updateInstructorBalances(
            0, //instShare=0 due to there is no new revenue on this transaction
            msg.sender,
            transactionTime,
            transactionLBIndex
        );
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            instBalance[msg.sender] &gt;= instRefundedBalance[msg.sender],
            "Debt is larger than balance"
        );
        /// @dev calculate the debt(refunded and blocked balance) amount and withdrawable balance of the instructor
        uint debtAmount = instRefundedBalance[msg.sender];
        uint withdrawableBalance = instBalance[msg.sender] - debtAmount;
        /// @dev zeroing before the actual withdraw
        instBalance[msg.sender] = 0;
        instRefundedBalance[msg.sender] = 0;
        /// @dev transfer the withdrawable balance to the instructor
        udao.transfer(msg.sender, withdrawableBalance);
&nbsp;
        emit InstructorWithdrawn(msg.sender, withdrawableBalance, debtAmount);
    }
&nbsp;
    /// @notice returns the withdrawable balance of the instructor
    /// @param _inst The address of the instructor
    /// @return withdrawableBalance The withdrawable balance of the given instructor
    function getWithdrawableBalanceInstructor(
        address _inst
    ) public view returns (uint) {
        /// @dev this is the timestamp of the transaction in days
        uint256 transactionTime = (block.timestamp / 86400);
        /// @dev transactionLBIndex determines a "transaction time dependent position" in the Locked balanaces array.
        uint256 transactionLBIndex = transactionTime % refundWindow;
        uint instPositiveBalance;
&nbsp;
        uint256 dayPassedInst = transactionTime - instLockTime[_inst];
        uint256 dayPassedInstMod;
        /// @dev if the instructor is locked for more than 2 refund window, the instructor will be able to withdraw all the locked balance
        <span class="missing-if-branch" title="if path not taken" >I</span>if (dayPassedInst &gt;= (refundWindow * 2)) {
            dayPassedInstMod = refundWindow - 1;
        } else {
            dayPassedInstMod = dayPassedInst % refundWindow;
        }
        /// @dev calculate the positive balance of the instructor
        for (uint256 i = 0; i &lt;= dayPassedInstMod; i++) {
            //Index of the day to be payout to instructor.
            uint256 indexOfPayout = ((transactionLBIndex + refundWindow) - i) %
                refundWindow;
            instPositiveBalance += instLockedBalance[_inst][indexOfPayout];
        }
        /// @dev if the instructor has a positive balance greater than the refunded and blocked balance, the instructor can withdraw the difference
        <span class="missing-if-branch" title="else path not taken" >E</span>if ((instPositiveBalance - instRefundedBalance[_inst]) &gt; 0) {
            return instPositiveBalance - instRefundedBalance[_inst];
        } else {
<span class="cstat-no" title="statement not covered" >            return 0;</span>
        }
    }
&nbsp;
    /// @notice Allows backend to change platform refun window period
    /// @param _newWindow The new refund window period
<span class="fstat-no" title="function not covered" >    function changeRefundWindow(uint256 _newWindow) external {</span>
<span class="cstat-no" title="statement not covered" >        require(</span>
            hasRole(BACKEND_ROLE, msg.sender),
            "Only backend can set refund window"
        );
        /// @dev this is the timestamp of the transaction in days
<span class="cstat-no" title="statement not covered" >        uint256 transactionTime = (block.timestamp / 86400);</span>
        /// @dev transactionLBIndex determines a "transaction time dependent position" in the Locked balanaces array.
<span class="cstat-no" title="statement not covered" >        uint256 transactionLBIndex = transactionTime % refundWindow;</span>
        /// @dev update platform cut (coaching&amp;content) pools and platform locked pools
<span class="cstat-no" title="statement not covered" >        _updatePlatformCutBalances(</span>
            0, //contentCut=0 due to there is no content revenue on this transaction
            0, //coachingCut=0 due to there is no coaching revenue on this transaction
            transactionTime,
            transactionLBIndex
        );
        /// @dev locked balances will be emptied and re-added to the platform cut pools
<span class="cstat-no" title="statement not covered" >        uint256 emptiedContentCutPool;</span>
<span class="cstat-no" title="statement not covered" >        uint256 emptiedCoachingCutPool;</span>
        /// @dev save the possession of locked balances and empty the locked balances
<span class="cstat-no" title="statement not covered" >        for (uint256 i = 0; i &lt; refundWindow; i++) {</span>
            emptiedContentCutPool += contentCutLockedPool[i];
            contentCutLockedPool[i] = 0;
            emptiedCoachingCutPool += coachingCutLockedPool[i];
            coachingCutLockedPool[i] = 0;
        }
        refundWindow = _newWindow;
<span class="cstat-no" title="statement not covered" >        emit RefundWindowUpdated(_newWindow);</span>
        /// @dev update platform cut (coaching&amp;content) pools and platform locked pools
<span class="cstat-no" title="statement not covered" >        _updatePlatformCutBalances(</span>
            emptiedContentCutPool,
            emptiedCoachingCutPool,
            transactionTime,
            transactionLBIndex
        );
        /// @dev if there is any revenue in platform cut pools, distribute role shares to roles and transfer governance role shares to governance treasury
<span class="cstat-no" title="statement not covered" >        _transferPlatformCutstoGovernance()</span>;
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed Nov 15 2023 10:12:08 GMT+0300 (GMT+03:00)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
