<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/tokens/UDAOC.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">contracts/tokens/</a> UDAOC.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">79.03% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>49/62</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">51.47% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>35/68</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">75% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>15/20</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">80.28% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>57/71</span>
      </div>
    </div>
  </div>
  <div class='status-line medium'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">213×</span>
<span class="cline-any cline-yes">213×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">142×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">142×</span>
<span class="cline-any cline-yes">142×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">142×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">13×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-yes">33×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-yes">4×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-yes">32×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
/// @title UDAOC (UDAO-Content) token is an ERC721 token.
pragma solidity ^0.8.4;
&nbsp;
import "@openzeppelin/contracts/token/ERC721/ERC721.sol";
import "@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol";
import "@openzeppelin/contracts/utils/Counters.sol";
import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
import "@openzeppelin/contracts/utils/cryptography/draft-EIP712.sol";
import "../interfaces/IUDAOC.sol";
import "../interfaces/ISupervision.sol";
import "../interfaces/IRoleManager.sol";
import "../RoleLegacy.sol";
import "@openzeppelin/contracts/security/Pausable.sol";
&nbsp;
contract UDAOContent is
    Pausable,
    RoleLegacy,
    IUDAOC,
    ERC721,
    EIP712,
    ERC721URIStorage
{
    using Counters for Counters.Counter;
    /// @dev The counter for content token ids.
    Counters.Counter private _tokenIds;
&nbsp;
    string private constant SIGNING_DOMAIN = "UDAOCMinter";
    string private constant SIGNATURE_VERSION = "1";
&nbsp;
    ISupervision supervision;
&nbsp;
    /// @param roleManagerAddress The address of the deployed role manager
    constructor(
        address roleManagerAddress
    )
        ERC721("UDAO Content", "UDAOC")
        EIP712(SIGNING_DOMAIN, SIGNATURE_VERSION)
    {
        roleManager = IRoleManager(roleManagerAddress);
        _tokenIds.increment();
    }
&nbsp;
    /// @dev tokenId =&gt; true/false (is sellable)
    mapping(uint256 =&gt; bool) public isSellable;
    /// @dev tokenId =&gt; partIds
    mapping(uint256 =&gt; uint256[]) public contentParts;
&nbsp;
    /// @notice This event is triggered when a new content is created
    event NewContentCreated(uint indexed tokenId, address indexed owner);
    /// @notice This event is triggered when a new part is added to a content
    event ContentModified(
        uint indexed tokenId,
        address indexed owner,
        uint newPartNumber
    );
    /// @notice This event is triggered if the contract manager updates the addresses.
    event AddressesUpdated(address RoleManager, address Supervision);
    /// @notice Triggered when KYC requirement for content creating is changed
    event KYCRequirementForCreateContentChanged(bool status);
&nbsp;
    ///@notice A signed voucher can be redeemed for a real content NFT using the redeem function.
    struct RedeemVoucher {
        /// @notice The date until the voucher is valid
        uint256 validUntil;
        /// @notice Parts of the content
        uint256[] _parts;
        /// @notice Token id of the content, not used if new content creation
        uint256 tokenId;
        /// @notice The metadata URI to associate with this token.
        string _uri;
        /// @notice Address of the redeemer
        address _redeemer;
        /// @notice Whether new content or modification, 0 undefined, 1 new content, 2 modification
        uint256 redeemType;
        /// @notice validaton score of the content
        uint256 validationScore;
        /// @notice the EIP-712 signature of all other fields in the CertificateVoucher struct.
        bytes signature;
    }
&nbsp;
    /// @notice Allows sale controller to set sellable status of a content
    /// @param _tokenId id of the content
    /// @param _isSellable is content sellable
    function setSellable(uint _tokenId, bool _isSellable) external {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            hasRole(SALE_CONTROLLER, msg.sender),
            "Only sale controller can set sellable"
        );
        isSellable[_tokenId] = _isSellable;
    }
&nbsp;
    /// @notice Get the updated addresses from contract manager
    /// @param roleManagerAddress The address of the role manager contract
    /// @param supervisionAddress The address of the supervision contract
    function updateAddresses(
        address roleManagerAddress,
        address supervisionAddress
    ) external {
        <span class="missing-if-branch" title="if path not taken" >I</span>if (msg.sender != foundationWallet) {
<span class="cstat-no" title="statement not covered" >            require(</span>
                (hasRole(BACKEND_ROLE, msg.sender) ||
                    hasRole(CONTRACT_MANAGER, msg.sender)),
                "Only backend can update addresses"
            );
        }
        roleManager = IRoleManager(roleManagerAddress);
        supervision = ISupervision(supervisionAddress);
&nbsp;
        emit AddressesUpdated(roleManagerAddress, supervisionAddress);
    }
&nbsp;
    /// @notice Redeems a RedeemVoucher for an actual NFT, creating it in the process.
    /// @param voucher A RedeemVoucher describing an unminted NFT.
    function createContent(
        RedeemVoucher calldata voucher
    ) public <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused {
        // make sure signature is valid and get the address of the signer
        address signer = _verify(voucher);
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            hasRole(VOUCHER_VERIFIER, signer),
            "Signature invalid or unauthorized"
        );
        // Revert if the msg.sender is not the voucher._redeemer or has the CONTENT_PUBLISHER role
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
<span class="branch-0 cbranch-no" title="branch not covered" >            hasRole(CONTENT_PUBLISHER, msg.sender)</span> ||
                voucher._redeemer == msg.sender,
            "Only content modifier or redeemer can create content"
        );
        <span class="missing-if-branch" title="else path not taken" >E</span>require(voucher.validUntil &gt;= block.timestamp, "Voucher has expired.");
        /// @dev 1 is new content, 2 is modification
        <span class="missing-if-branch" title="else path not taken" >E</span>require(voucher.redeemType == 1, "Redeem type is not new content");
        uint tokenId = _tokenIds.current();
        //make sure redeemer is kyced
        <span class="missing-if-branch" title="else path not taken" >E</span>require(isKYCed(voucher._redeemer, 13), "You are not KYCed");
        //make sure redeemer is not banned
        <span class="missing-if-branch" title="else path not taken" >E</span>require(isNotBanned(voucher._redeemer, 13), "Redeemer is banned!");
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            !isCalldataStringEmpty(voucher._uri),
            "Content URI cannot be empty"
        );
&nbsp;
        // save the content parts
        contentParts[tokenId] = voucher._parts;
&nbsp;
        _mint(voucher._redeemer, tokenId);
        _setTokenURI(tokenId, voucher._uri);
        _tokenIds.increment();
        isSellable[tokenId] = true;
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>if (voucher.validationScore != 0) {
            supervision.createValidation(tokenId, voucher.validationScore);
        }
        emit NewContentCreated(tokenId, voucher._redeemer);
    }
&nbsp;
    /// @notice Checks if a string is empty
    /// @param input The string to check
    function isCalldataStringEmpty(
        string calldata input
    ) internal pure returns (bool) {
        return
            keccak256(abi.encodePacked(input)) ==
            keccak256(abi.encodePacked(""));
    }
&nbsp;
    /// @notice Allows modification of a content by redeeming a voucher.
    /// @param voucher A RedeemVoucher describing an unminted NFT.
    function modifyContent(
        RedeemVoucher calldata voucher
    ) external <span class="missing-if-branch" title="else path not taken" >E</span>whenNotPaused {
        // make sure signature is valid and get the address of the signer
        address signer = _verify(voucher);
        <span class="missing-if-branch" title="else path not taken" >E</span>require(
            hasRole(VOUCHER_VERIFIER, signer),
            "Signature invalid or unauthorized"
        );
        // Revert if the msg.sender is not the owner of the content or has the CONTENT_PUBLISHER role
        require(
<span class="branch-0 cbranch-no" title="branch not covered" >            hasRole(CONTENT_PUBLISHER, msg.sender)</span> ||
                ownerOf(voucher.tokenId) == msg.sender,
            "Only content modifier or owner can modify content"
        );
        <span class="missing-if-branch" title="else path not taken" >E</span>require(voucher.validUntil &gt;= block.timestamp, "Voucher has expired.");
        /// @dev 1 is new content, 2 is modification
        <span class="missing-if-branch" title="else path not taken" >E</span>require(voucher.redeemType == 2, "Redeem type is not modification");
        address instructor = ownerOf(voucher.tokenId);
        //make sure redeemer is kyced
        require(isKYCed(instructor, 14), "You are not KYCed");
        // make sure caller is not banned
        require(isNotBanned(instructor, 14), "You are banned");
        // A content can be modified only if it is not in validation
        <span class="missing-if-branch" title="if path not taken" >I</span>if (voucher.validationScore != 0) {
<span class="cstat-no" title="statement not covered" >            require(</span>
                /// @dev 0: rejected, 1: validated, 2: in validation
                supervision.getIsValidated(voucher.tokenId) != 2,
                "Content is already in validation"
            );
        }
        /// @dev Create the new token
        contentParts[voucher.tokenId] = voucher._parts;
&nbsp;
        _setTokenURI(voucher.tokenId, voucher._uri);
&nbsp;
        <span class="missing-if-branch" title="if path not taken" >I</span>if (voucher.validationScore != 0) {
<span class="cstat-no" title="statement not covered" >            supervision.createValidation(</span>
                voucher.tokenId,
                voucher.validationScore
            );
        }
&nbsp;
        emit ContentModified(
            voucher.tokenId,
            voucher._redeemer,
            voucher._parts.length
        );
    }
&nbsp;
    /// @notice returns the parts array of a specific content
    /// @param tokenId the content ID of the token
    function getContentParts(
        uint tokenId
    ) external view returns (uint256[] memory) {
        return (contentParts[tokenId]);
    }
&nbsp;
    /// @notice Returns the part numbers that a content has
<span class="fstat-no" title="function not covered" >    function _getPartNumberOfContent(</span>
        uint tokenId
    ) internal view returns (uint) {
<span class="cstat-no" title="statement not covered" >        return contentParts[tokenId].length;</span>
    }
&nbsp;
    /// @notice Returns the part numbers that a content has
    function getPartNumberOfContent(uint tokenId) external view returns (uint) {
        return contentParts[tokenId].length;
    }
&nbsp;
    /// @notice Burns a content which is not allowed
    /// @param tokenId The id of the token to burn
<span class="fstat-no" title="function not covered" >    function _burn(</span>
        uint256 tokenId
    ) internal override(ERC721, ERC721URIStorage) {
<span class="cstat-no" title="statement not covered" >        require(</span>
            hasRole(BACKEND_ROLE, msg.sender),
            "Only backend can burn a content"
        );
<span class="cstat-no" title="statement not covered" >        super._burn(tokenId)</span>;
    }
&nbsp;
    /// @notice Allows transfer of a content with KYC and ban checks
    /// @param from The current token owner
    /// @param to Token to send to
    /// @param tokenId The id of the token to transfer
    function _beforeTokenTransfer(
        address from,
        address to,
        uint256 tokenId
    ) internal virtual override {
        super._beforeTokenTransfer(from, to, tokenId);
        <span class="missing-if-branch" title="else path not taken" >E</span>if (to != address(0)) {
            <span class="missing-if-branch" title="else path not taken" >E</span>require(isKYCed(to, 18), "Receiver is not KYCed!");
            require(isNotBanned(to, 18), "Receiver is banned!");
        }
        if (from != address(0)) {
            require(isKYCed(from, 19), "Sender is not KYCed!");
            require(isNotBanned(from, 19), "Sender is banned!");
        }
    }
&nbsp;
    /// @notice Allows off-chain check if batch of tokens(content) exists
    /// @param tokenIds Array of token IDs
<span class="fstat-no" title="function not covered" >    function existsBatch(</span>
        uint[] memory tokenIds
    ) external view returns (bool[] memory) {
<span class="cstat-no" title="statement not covered" >        bool[] memory existanceResult;</span>
<span class="cstat-no" title="statement not covered" >        for (uint i = 0; i &lt; tokenIds.length; i++) {</span>
            existanceResult[i] = _exists(tokenIds[i]);
        }
<span class="cstat-no" title="statement not covered" >        return existanceResult;</span>
    }
&nbsp;
    /// @notice Allows off-chain check if a token(content) exists
    /// @param tokenId The ID of a token
    function exists(uint tokenId) external view returns (bool) {
        return _exists(tokenId);
    }
&nbsp;
    /// @notice Returns a hash of the given RedeemVoucher, prepared using EIP712 typed data hashing rules.
    /// @param voucher A RedeemVoucher to hash.
    function _hash(
        RedeemVoucher calldata voucher
    ) internal view returns (bytes32) {
        return
            _hashTypedDataV4(
                keccak256(
                    abi.encode(
                        keccak256(
                            "RedeemVoucher(uint256 validUntil,uint256[] _parts,uint256 tokenId,string _uri,address _redeemer,uint256 redeemType,uint256 validationScore)"
                        ),
                        voucher.validUntil,
                        keccak256(abi.encodePacked(voucher._parts)),
                        voucher.tokenId,
                        keccak256(bytes(voucher._uri)),
                        voucher._redeemer,
                        voucher.redeemType,
                        voucher.validationScore
                    )
                )
            );
    }
&nbsp;
    /// @notice Returns the chain id of the current blockchain.
    /// @dev This is used to workaround an issue with ganache returning different values from the on-chain chainid() function and
    ///  the eth_chainId RPC method. See https://github.com/protocol/nft-website/issues/121 for context.
    function getChainID() external view returns (uint256) {
        uint256 id;
        assembly {
            id := chainid()
        }
        return id;
    }
&nbsp;
    /// @notice Verifies the signature for a given RedeemVoucher, returning the address of the signer.
    /// @dev Will revert if the signature is invalid. Does not verify that the signer is authorized to mint NFTs.
    /// @param voucher A RedeemVoucher describing an unminted NFT.
    function _verify(
        RedeemVoucher calldata voucher
    ) internal view returns (address) {
        bytes32 digest = _hash(voucher);
        return ECDSA.recover(digest, voucher.signature);
    }
&nbsp;
    /// @notice Allows backend to pause the contract
<span class="fstat-no" title="function not covered" >    function pause() external {</span>
<span class="cstat-no" title="statement not covered" >        require(hasRole(BACKEND_ROLE, msg.sender), "Only backend can pause")</span>;
<span class="cstat-no" title="statement not covered" >        _pause()</span>;
    }
&nbsp;
    /// @notice Allows backend to unpause the contract
<span class="fstat-no" title="function not covered" >    function unpause() external {</span>
<span class="cstat-no" title="statement not covered" >        require(hasRole(BACKEND_ROLE, msg.sender), "Only backend can unpause")</span>;
<span class="cstat-no" title="statement not covered" >        _unpause()</span>;
    }
&nbsp;
    // The following functions are overrides required by Solidity.
&nbsp;
    function tokenURI(
        uint256 tokenId
    ) public view override(ERC721, ERC721URIStorage) returns (string memory) {
        return super.tokenURI(tokenId);
    }
&nbsp;
    function supportsInterface(
        bytes4 interfaceId
    ) public view override(ERC721, IERC165) returns (bool) {
        return super.supportsInterface(interfaceId);
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed Nov 15 2023 10:12:08 GMT+0300 (GMT+03:00)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
